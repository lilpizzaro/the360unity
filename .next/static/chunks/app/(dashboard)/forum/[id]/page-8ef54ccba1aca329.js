(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5998],{707:(e,r,t)=>{Promise.resolve().then(t.bind(t,1304))},1304:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>m});var a=t(8711),s=t(2115),i=t(5695),n=t(6874),l=t.n(n),d=t(5095),o=t(5387),c=t(4788);function m(){let e=(0,i.useParams)(),r=(0,i.useRouter)(),{user:t,isLoaded:n}=(0,c.Jd)(),[m,h]=(0,s.useState)(null),[u,p]=(0,s.useState)([]),[f,x]=(0,s.useState)(!0),[b,g]=(0,s.useState)(null),[w,N]=(0,s.useState)(""),[v,y]=(0,s.useState)(!1),Y=e.id;(0,s.useEffect)(()=>{let e=async()=>{x(!0),g(null);try{let e=await fetch("/api/forum");if(!e.ok)throw Error("Failed to fetch discussions");let r=(await e.json()).find(e=>e.id===parseInt(Y));if(!r)throw Error("Thread not found");h(r);let t=await fetch("/api/forum/comments?postId=".concat(Y));if(!t.ok)throw Error("Failed to fetch replies");let a=await t.json();p(a)}catch(e){console.error("Error fetching thread:",e),g(e.message||"Failed to load discussion. Please try again.")}finally{x(!1)}};Y&&e()},[Y]);let F=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),D=async e=>{if(e.preventDefault(),w.trim()){y(!0);try{let e=await fetch("/api/forum/comments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({postId:parseInt(Y),content:w}),credentials:"include"});if(!e.ok){let r=await e.json();throw Error(r.error||"Failed to post reply")}let r=await e.json();p([...u,r]),N(""),m&&h({...m,replies:m.replies+1,lastActivity:new Date().toISOString(),lastAuthor:(null==t?void 0:t.fullName)||(null==t?void 0:t.username)||"Anonymous"})}catch(e){console.error("Error posting reply:",e),alert("Failed to post reply. Please try again.")}finally{y(!1)}}};return f?(0,a.FD)(a.FK,{children:[(0,a.Y)(d.default,{}),(0,a.Y)("div",{className:"min-h-screen pt-24 px-6",children:(0,a.Y)("div",{className:"max-w-4xl mx-auto",children:(0,a.Y)("div",{className:"flex justify-center items-center py-12",children:(0,a.Y)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-cyan"})})})})]}):b||!m?(0,a.FD)(a.FK,{children:[(0,a.Y)(d.default,{}),(0,a.Y)("div",{className:"min-h-screen pt-24 px-6",children:(0,a.Y)("div",{className:"max-w-4xl mx-auto",children:(0,a.FD)("div",{className:"mb-6 p-6 bg-red-500/20 border border-red-500/50 rounded-lg text-red-300 text-center",children:[(0,a.Y)("p",{className:"mb-4",children:b||"Thread not found"}),(0,a.Y)("button",{onClick:()=>r.push("/forum"),className:"px-4 py-2 bg-red-500/30 hover:bg-red-500/40 rounded-lg transition-colors",children:"Back to Forum"})]})})})]}):(0,a.FD)(a.FK,{children:[(0,a.Y)(d.default,{}),(0,a.Y)("div",{className:"min-h-screen pt-24 px-6",children:(0,a.FD)("div",{className:"max-w-4xl mx-auto",children:[(0,a.Y)("div",{className:"mb-6",children:(0,a.FD)(l(),{href:"/forum",className:"inline-flex items-center text-white/70 hover:text-white transition-colors",children:[(0,a.Y)(o.A6,{size:16,className:"mr-2"}),"Back to Forum"]})}),(0,a.FD)("div",{className:"bg-white/5 rounded-2xl p-6 backdrop-blur-sm border border-white/10 mb-6",children:[(0,a.FD)("div",{className:"flex items-center mb-4",children:[(0,a.Y)("span",{className:"text-sm bg-white/10 px-2 py-1 rounded-full mr-2",children:m.categoryName}),m.pinned&&(0,a.Y)("span",{className:"text-xs bg-cyan/20 text-cyan px-2 py-1 rounded-full mr-2",children:"Pinned"}),m.solved&&(0,a.Y)("span",{className:"text-xs bg-green-500/20 text-green-400 px-2 py-1 rounded-full",children:"Solved"})]}),(0,a.Y)("h1",{className:"t-heading-lg mb-4",children:m.title}),(0,a.Y)("div",{className:"flex flex-wrap gap-2 mb-6",children:m.tags.map(e=>(0,a.FD)("span",{className:"text-xs px-2 py-1 bg-white/10 rounded-full text-white/80",children:["#",e]},e))}),(0,a.FD)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.FD)("div",{className:"flex items-center",children:[m.author.imageUrl?(0,a.Y)("img",{src:m.author.imageUrl,alt:m.author.name,className:"w-10 h-10 rounded-full mr-3"}):(0,a.Y)("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-cyan-500 rounded-full flex items-center justify-center text-sm font-bold mr-3",children:m.author.name[0]}),(0,a.FD)("div",{children:[(0,a.Y)("div",{className:"font-medium",children:m.author.name}),(0,a.Y)("div",{className:"text-sm text-white/70",children:F(m.createdAt)})]})]}),(0,a.FD)("div",{className:"text-sm text-white/70",children:[(0,a.FD)("span",{children:[m.views," views"]}),(0,a.Y)("span",{className:"mx-2",children:"â€¢"}),(0,a.FD)("span",{children:[m.replies," replies"]})]})]}),(0,a.Y)("div",{className:"prose prose-invert max-w-none",children:(0,a.Y)("p",{children:m.content})})]}),(0,a.FD)("div",{className:"mb-8",children:[(0,a.FD)("h2",{className:"t-heading-md mb-6",children:["Replies (",u.length,")"]}),u.length>0?(0,a.Y)("div",{className:"space-y-6",children:u.map(e=>(0,a.FD)("div",{className:"bg-white/5 rounded-2xl p-6 backdrop-blur-sm border ".concat(e.isAnswer?"border-green-500/30":"border-white/10"),children:[e.isAnswer&&(0,a.FD)("div",{className:"inline-flex items-center gap-1 bg-green-500/20 text-green-400 text-xs px-3 py-1 rounded-full mb-4",children:[(0,a.Y)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,a.Y)("path",{d:"M20 6 9 17l-5-5"})}),"Solution"]}),(0,a.FD)("div",{className:"flex items-center mb-4",children:[e.author.imageUrl?(0,a.Y)("img",{src:e.author.imageUrl,alt:e.author.name,className:"w-8 h-8 rounded-full mr-3"}):(0,a.Y)("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-500 to-cyan-500 rounded-full flex items-center justify-center text-xs font-bold mr-3",children:e.author.name[0]}),(0,a.FD)("div",{children:[(0,a.Y)("div",{className:"font-medium",children:e.author.name}),(0,a.Y)("div",{className:"text-xs text-white/70",children:F(e.createdAt)})]})]}),(0,a.Y)("div",{className:"prose prose-invert max-w-none",children:(0,a.Y)("p",{children:e.content})})]},e.id))}):(0,a.FD)("div",{className:"text-center py-8 bg-white/5 rounded-2xl backdrop-blur-sm border border-white/10",children:[(0,a.Y)("p",{className:"text-white/70 mb-2",children:"No replies yet"}),(0,a.Y)("p",{className:"text-white/70",children:"Be the first to reply to this discussion!"})]})]}),n&&t?(0,a.FD)("div",{className:"bg-white/5 rounded-2xl p-6 backdrop-blur-sm border border-white/10",children:[(0,a.Y)("h3",{className:"t-heading-sm mb-4",children:"Post a Reply"}),(0,a.FD)("form",{onSubmit:D,children:[(0,a.Y)("div",{className:"mb-4",children:(0,a.Y)("textarea",{rows:6,value:w,onChange:e=>N(e.target.value),placeholder:"Write your reply here...",className:"w-full bg-white/5 border border-white/10 rounded-lg p-3 text-white font-mono text-sm",required:!0})}),(0,a.Y)("div",{className:"flex justify-end",children:(0,a.FD)("button",{type:"submit",disabled:v||!w.trim(),className:"btn-primary px-6 py-3 flex items-center gap-2",children:[(0,a.Y)(o.PB,{size:18}),v?"Posting...":"Post Reply"]})})]})]}):(0,a.FD)("div",{className:"bg-white/5 rounded-2xl p-6 backdrop-blur-sm border border-white/10 text-center",children:[(0,a.Y)("p",{className:"mb-4",children:"You need to sign in to reply to this discussion"}),(0,a.Y)(l(),{href:"/sign-in",className:"btn-primary px-6 py-3 inline-block",children:"Sign In"})]})]})})]})}},5695:(e,r,t)=>{"use strict";var a=t(8999);t.o(a,"useParams")&&t.d(r,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})}},e=>{var r=r=>e(e.s=r);e.O(0,[4788,6874,8711,4085,8441,1684,7358],()=>r(707)),_N_E=e.O()}]);